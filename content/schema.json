{
  "$ref": "#/definitions/german-mastery-unit-scchema",
  "definitions": {
    "german-mastery-unit-scchema": {
      "type": "object",
      "properties": {
        "_$schema": {
          "type": "string"
        },
        "id": {
          "type": "string",
          "format": "uuid"
        },
        "title": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "order": {
          "type": "integer",
          "minimum": 1
        },
        "lessons": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "title": {
                "type": "string",
                "minLength": 1
              },
              "order": {
                "type": "integer",
                "minimum": 1
              },
              "content": {
                "type": "object",
                "properties": {
                  "introVideoUrl": {
                    "type": "string",
                    "format": "uri"
                  },
                  "exercises": {
                    "type": "array",
                    "items": {
                      "anyOf": [
                        {
                          "type": "object",
                          "properties": {
                            "id": {
                              "type": "string",
                              "format": "uuid"
                            },
                            "prompt": {
                              "type": "string",
                              "minLength": 1
                            },
                            "audioUrl": {
                              "type": "string",
                              "format": "uri"
                            },
                            "type": {
                              "type": "string",
                              "const": "multiple_choice"
                            },
                            "options": {
                              "type": "array",
                              "items": {
                                "type": "string",
                                "minLength": 1
                              },
                              "minItems": 2
                            },
                            "correctOptionIndex": {
                              "type": "integer",
                              "minimum": 0
                            },
                            "explanation": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "id",
                            "prompt",
                            "type",
                            "options",
                            "correctOptionIndex"
                          ],
                          "additionalProperties": false
                        },
                        {
                          "type": "object",
                          "properties": {
                            "id": {
                              "$ref": "#/definitions/german-mastery-unit-scchema/properties/lessons/items/properties/content/properties/exercises/items/anyOf/0/properties/id"
                            },
                            "prompt": {
                              "$ref": "#/definitions/german-mastery-unit-scchema/properties/lessons/items/properties/content/properties/exercises/items/anyOf/0/properties/prompt"
                            },
                            "audioUrl": {
                              "$ref": "#/definitions/german-mastery-unit-scchema/properties/lessons/items/properties/content/properties/exercises/items/anyOf/0/properties/audioUrl"
                            },
                            "type": {
                              "type": "string",
                              "const": "word_bank"
                            },
                            "sentenceParts": {
                              "type": "array",
                              "items": {
                                "type": "string",
                                "minLength": 1
                              },
                              "minItems": 2
                            },
                            "correctOrder": {
                              "type": "array",
                              "items": {
                                "type": "integer",
                                "minimum": 0
                              },
                              "minItems": 1
                            },
                            "distractors": {
                              "type": "array",
                              "items": {
                                "type": "string",
                                "minLength": 1
                              }
                            }
                          },
                          "required": [
                            "id",
                            "prompt",
                            "type",
                            "sentenceParts",
                            "correctOrder"
                          ],
                          "additionalProperties": false
                        },
                        {
                          "type": "object",
                          "properties": {
                            "id": {
                              "$ref": "#/definitions/german-mastery-unit-scchema/properties/lessons/items/properties/content/properties/exercises/items/anyOf/0/properties/id"
                            },
                            "prompt": {
                              "$ref": "#/definitions/german-mastery-unit-scchema/properties/lessons/items/properties/content/properties/exercises/items/anyOf/0/properties/prompt"
                            },
                            "audioUrl": {
                              "$ref": "#/definitions/german-mastery-unit-scchema/properties/lessons/items/properties/content/properties/exercises/items/anyOf/0/properties/audioUrl"
                            },
                            "type": {
                              "type": "string",
                              "const": "typing"
                            },
                            "correctAnswer": {
                              "type": "string",
                              "minLength": 1
                            },
                            "acceptableAnswers": {
                              "type": "array",
                              "items": {
                                "type": "string",
                                "minLength": 1
                              }
                            }
                          },
                          "required": [
                            "id",
                            "prompt",
                            "type",
                            "correctAnswer"
                          ],
                          "additionalProperties": false
                        },
                        {
                          "type": "object",
                          "properties": {
                            "id": {
                              "$ref": "#/definitions/german-mastery-unit-scchema/properties/lessons/items/properties/content/properties/exercises/items/anyOf/0/properties/id"
                            },
                            "prompt": {
                              "$ref": "#/definitions/german-mastery-unit-scchema/properties/lessons/items/properties/content/properties/exercises/items/anyOf/0/properties/prompt"
                            },
                            "audioUrl": {
                              "$ref": "#/definitions/german-mastery-unit-scchema/properties/lessons/items/properties/content/properties/exercises/items/anyOf/0/properties/audioUrl"
                            },
                            "type": {
                              "type": "string",
                              "const": "match_pairs"
                            },
                            "pairs": {
                              "type": "array",
                              "items": {
                                "type": "object",
                                "properties": {
                                  "left": {
                                    "type": "string",
                                    "minLength": 1
                                  },
                                  "right": {
                                    "type": "string",
                                    "minLength": 1
                                  }
                                },
                                "required": [
                                  "left",
                                  "right"
                                ],
                                "additionalProperties": false
                              },
                              "minItems": 2
                            }
                          },
                          "required": [
                            "id",
                            "prompt",
                            "type",
                            "pairs"
                          ],
                          "additionalProperties": false
                        },
                        {
                          "type": "object",
                          "properties": {
                            "id": {
                              "$ref": "#/definitions/german-mastery-unit-scchema/properties/lessons/items/properties/content/properties/exercises/items/anyOf/0/properties/id"
                            },
                            "prompt": {
                              "$ref": "#/definitions/german-mastery-unit-scchema/properties/lessons/items/properties/content/properties/exercises/items/anyOf/0/properties/prompt"
                            },
                            "audioUrl": {
                              "$ref": "#/definitions/german-mastery-unit-scchema/properties/lessons/items/properties/content/properties/exercises/items/anyOf/0/properties/audioUrl"
                            },
                            "type": {
                              "type": "string",
                              "const": "listening"
                            },
                            "correctTranscript": {
                              "type": "string",
                              "minLength": 1
                            }
                          },
                          "required": [
                            "id",
                            "prompt",
                            "type",
                            "correctTranscript"
                          ],
                          "additionalProperties": false
                        }
                      ]
                    },
                    "minItems": 1
                  },
                  "passingScore": {
                    "type": "number",
                    "minimum": 0,
                    "maximum": 1,
                    "default": 0.8
                  }
                },
                "required": [
                  "exercises"
                ],
                "additionalProperties": false
              }
            },
            "required": [
              "title",
              "order",
              "content"
            ],
            "additionalProperties": false
          },
          "minItems": 1
        }
      },
      "required": [
        "title",
        "order",
        "lessons"
      ],
      "additionalProperties": false
    }
  },
  "$schema": "http://json-schema.org/draft-07/schema#"
}